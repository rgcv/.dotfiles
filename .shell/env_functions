#!/bin/sh
# shellcheck disable=SC2086
# PATH-like environment variable manipulation functions
__append()  { export $2="${3:+$3:}$1"; }
__prepend() { export $2="$1${3:+:$3}"; }

__inpath() {
  v=$(eval "echo \$$2")
  case ":$v:" in
    *:"$1":*) ;;
    *) echo "$v" ;;
  esac; unset v
}

__pathadd() {
  expanded=$(__inpath "$2" "$3")
  [ -n "$expanded" ] && $1 "$2" "$3" "$expanded"
}

pathappend()  { __pathadd __append  "$1" "${2-PATH}"; }
pathprepend() { __pathadd __prepend "$1" "${2-PATH}"; }
