#!/bin/sh
# requires:
#   bemenu (bemenu, option selection)
#   i3:
#     i3-msg (i3, exiting i3)
#   sway:
#     swaymsg (sway, exiting sway)
set -eu

choice=$(with-env bemenu -i -p System <<EOF | tr '[:upper:]' '[:lower:]'
Logout
Suspend
Restart
Hibernate
Shutdown
EOF
)

[ -n "$choice" ] || exit
case $(printf 'no\nyes' | with-env bemenu -p "Are you sure you want to $choice?") in
  y*) ;;
   *) exit ;;
esac

sync

case $choice in
  logout)
    if [ -n "${SWAYLOCK-}" ]; then
      swaymsg exit
    else
      i3-msg exit
    fi ;;
  restart)  systemctl reboot    ;;
  shutdown) systemctl poweroff  ;;
  *)        systemctl "$choice" ;;
esac

